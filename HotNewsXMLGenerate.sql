select top 200  A.id,title=A.name,des=A.des,source=A.source,date=A.datetime,datetimeid=A.datetimeid,isHot=A.isHot,  ranking=A.ranking,link=A.link, image=A.image,totalcomment=A.totalcomment,maindomain=A.maindomain, uplikes=A.uplikes,downlikes=A.downlikes, topicid=A.topicid,catid=A.catid,hasContent=A.hasContent,datediff(minute,A.datetime,GETDATE()) as timediff,  nameRelated=B.nameRelated,topicidRelated=B.topicidRelated,idRelated=B.idRelated, linkRelated=B.linkRelated,maindomainRelated=B.maindomainRelated,rankingRelated=B.rankingRelated,hasContentRelated=B.hasContentRelated,imageRelated=B.imageRelated from  
(select top 100 name,des,datetimeid,isHot,datetime,source,ranking,topicid,catid,id,link,image,totalcomment,maindomain,uplikes,downlikes,hasContent from [tinviet_vietnam].[tinviet_admin].[titles] where datetimeid>=20150427 and isHot>=1 and (topicid=id or topicid is null or catid=0) order by  datetimeid desc, ranking desc, id desc) as A left join  
(select datetimeid,name as nameRelated,topicid as topicidRelated,id as idRelated,link as linkRelated,maindomain as maindomainRelated,ranking as rankingRelated,hasContent as hasContentRelated,image as imageRelated from [tinviet_vietnam].[tinviet_admin].[titles] where datetimeid>=20150427 and catid<>0 and id=-1) as B on (A.topicid=B.topicidRelated and A.topicid=A.id)  
order by A.datetimeid desc,A.isHot desc,A.ranking desc,A.id desc,B.idRelated desc,B.rankingRelated desc