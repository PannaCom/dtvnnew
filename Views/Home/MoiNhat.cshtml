@model youknow.Views.ModelClassViewNewsManager
@{
    ViewBag.Title = "Mới Nhất";
    ViewBag.Url = "Home/MoiNhat";
    Layout = "~/Views/Shared/_LayoutPage.cshtml";
    int? uplikes = 0;
    int? downlikes = 0;
    string upimage = "up1.png";
    string downimage = "down1.png";
    string diemclass = "Diem";
    int currentNo = 0;
    int noNewsItem = -1;
    string styleComment = "";
    string title = "";
    string titleNoMark = "";
    string strCare = "Quan tâm";
    int catid = 0;
    int i = 0;
    int preID = -1;// Model.ieViewNews.ElementAt(0).id;
    int lastID = preID;
    string preRelatedNews = "";
    int preCountItemRelated = 0;
    var styleItem = "display:block;";
    string filterDomain = "";
    string filterCat = "";
    string preDomain = "," + Model.ieViewNews.ElementAt(0).maindomain + ",";
    string left = "left";
    //string topNews = "";
    //string twoHotNews = "";
    string listId = "";// "," + Model.ieViewNews.ElementAt(0).id + "," + Model.ieViewNews.ElementAt(1).id + "," + Model.ieViewNews.ElementAt(2).id + ",";
    if (ViewBag.filterCat != null)
    {
        filterCat = ViewBag.filterCat;
    }
    if (ViewBag.filterDomain != null)
    {
        filterDomain = ViewBag.filterDomain;
    }
    //youknow.Views.viewNewsManager[] Aitem = (youknow.Views.viewNewsManager[])Model.ieViewNews;
    preRelatedNews = "<span class=\\\"sameTopicTitleFont\\\">Tin liên quan</span>";
    string HotTitle1 = "";
    string HotId1 = "";
    string HotImage1 = "";
    string HotDomain1 = "";
    string HotDate1 = "";
    string HotTitle2 = "";
    string HotId2 = "";
    string HotImage2 = "";
    string HotDomain2 = "";
    string HotDate2 = "";
    string HotTitle3 = "";
    string HotId3 = "";
    string HotImage3 = "";
    string HotDomain3 = "";
    string HotDate3 = "";
    currentNo = 0;
    //Lay ra 3 tin dau tien
    foreach (youknow.Views.viewNewsManager item in Model.ieViewNews)
    {
        if (preID != item.id)
        {
            if (currentNo == 0)
            {
                HotTitle1 = System.Web.HttpUtility.HtmlDecode(item.title);
                HotId1 = item.id.ToString();
                HotImage1 = item.image;
                HotDomain1 = item.maindomain;
                HotDate1 = youknow.Uti.getDiffTimeFromNow(@item.date.ToString());
                listId += "," + item.id.ToString() + ",";
            }
            if (currentNo == 1)
            {
                HotTitle2 = System.Web.HttpUtility.HtmlDecode(item.title);
                HotId2 = item.id.ToString();
                HotImage2 = item.image;
                HotDomain2 = item.maindomain;
                HotDate2 = youknow.Uti.getDiffTimeFromNow(@item.date.ToString());
                listId += "," + item.id.ToString() + ",";
            }
            if (currentNo == 2)
            {
                HotTitle3 = System.Web.HttpUtility.HtmlDecode(item.title);
                HotId3 = item.id.ToString();
                HotImage3 = item.image;
                HotDomain3 = item.maindomain;
                HotDate3 = youknow.Uti.getDiffTimeFromNow(@item.date.ToString());
                listId += "," + item.id.ToString() + ",";
            }
            preID = item.id;
            currentNo++;
        }
        else {continue;}
        if (currentNo > 2) {break;}
    }
    currentNo = 0;
    preID = -1;
}

<script src="~/Scripts/jquery-2.1.1.js"></script>
<script src="~/Scripts/jquery.cookie.js"></script> 
<script  src="/Scripts/core.js" type="text/javascript"></script> 
    <div class="container" id="top-header" style="display:none;">
            <div class="col-md-8 padding-0" id="HotestDv">
                    <div class="lagre-img-box">                    
                    <a href="/Home/DocBao/@HotId1" class="lagre-link" title="@HotTitle1">
                        <span class="title-lagre-domain">@HotDomain1</span>
                        <img src="@HotImage1" class="lagre-img" alt="@HotTitle1">
                        <span class="title-lagre">@HotTitle1&nbsp(@HotDate1)</span>                        
                    </a>
                </div>
            </div>
            <div class="col-md-4 top-news padding-r-0 padding-l-10">
                <ul class="list-top" id="TwoHotestItem">
                    <li>
                        <a href="/Home/DocBao/@HotId2" title="@HotTitle2">
                            <span class="list-top-title-domain">@HotDomain2</span>
                            <img src="@HotImage2" class="list-top-img" alt="@HotTitle2">
                            <span class="list-top-title">
                                @HotTitle2&nbsp(@HotDate2)
                            </span>
                        </a>
                    </li>    
                    <li>
                        <a href="/Home/DocBao/@HotId3" title="@HotTitle3">
                            <span class="list-top-title-domain">@HotDomain3</span>
                            <img src="@HotImage3" class="list-top-img" alt="@HotTitle3">
                            <span class="list-top-title">
                                @HotTitle3&nbsp(@HotDate3)
                            </span>
                        </a>
                    </li>                 
                </ul>
                <div class="clear-fix"></div>
            </div>
    </div>
    <!-- /.container -->
<div class="container" id="main-content">
 <div class="col-md-8 padding-0" id="left-col">
    @foreach (youknow.Views.viewNewsManager item in Model.ieViewNews)
    {

        lastID = item.id;
        //if (listId.Contains("," + item.id + ",")) { continue; }
        //Nếu là các tin liên quan thì đọc và tiếp tục đọc các dòng sau.
        if (preID == item.id)//Đây là tin liên quan, cộng vào chuỗi và bỏ qua
        {
            //preRelatedNews += "<li>";
            //preRelatedNews += "<a href=\\\"/Home/DocBao/" + item.idRelated + "\\\" class=\\\"news-box-link\\\">";
            //preRelatedNews += "<img src=\\\"" + item.imageRelated + "\\\" class=\\\"news-box-list-img\\\" alt=\\\"" + item.nameRelated + "\\\">";
            //preRelatedNews += "<span class=\\\"news-box-list-item\\\">";
            //preRelatedNews += item.nameRelated;
            //preRelatedNews += "</span>";
            //preRelatedNews += "</a>";
            //preRelatedNews += "</li>";
            //preCountItemRelated++;   
            continue;
        }
        //Nếu chuyển sang tin khác thì ghi ra tin liên quan.
        if (preID != item.id)
        {
            //<text>
            //<script>
            //$("#r_@preID").append("@Html.Raw(@preRelatedNews)");
            //</script>
            //</text>
            preID = item.id;
            preRelatedNews = "";
            preCountItemRelated = 0;
            //if (currentNo == 0) { 
            //    topNews="<div class=\\\"lagre-img-box\\\">";
            //    topNews+="<a href=\\\"#\\\" class=\\\"lagre-link\\\" title=\\\""+item.title+"\\\">";
            //    topNews+="<img src=\\\""+item.image+"\\\" class=\\\"lagre-img\\\" alt=\\\""+item.title+"\\\">";
            //    topNews+="<span class=\\\"title-lagre\\\">Hiện trường vụ MH17 nhìn từ vệ tinh</span>";
            //    topNews+="</a>";
            //    topNews += "</div>";
            //}
        }
        styleComment = "";
        uplikes = 0;
        downlikes = 0;
        upimage = "up1.png";
        downimage = "down1.png";
        diemclass = "Diem";
        title = System.Web.HttpUtility.HtmlDecode(item.title);
        titleNoMark = youknow.Uti.unicodeToNoMark(title);
        currentNo = currentNo + 1;
        if (currentNo % 2 == 0)
        {
            left = "left";
        }
        else
        {
            left = "right";
        }

        catid = 0;
        if (item.catid != null && item.catid != 0) { catid = (int)item.catid; }                
         <text> 
                <div class="news-box news-box-@left">
                    <h3 class="news-box-title">@item.maindomain.Replace("http://", "").Replace("www.", "")</h3>
                    <ul class="list-news-box" id="r_@item.id">
                        <li>
                            <a href="/Home/DocBao/@item.id/@titleNoMark" class="news-box-link">
                                <img src="@item.image" class="news-box-list-img" alt="@title">
                                <span class="news-box-list-item">
                                    @title&nbsp;(@youknow.Uti.getDiffTimeFromNow(@item.date.ToString()))
                                </span>
                            </a>
                        </li>
                    </ul>
                </div>
        </text>
    }    
    <div class="clear-fix"></div>
    </div>
    
    <div class="col-md-4 padding-r-0 padding-l-10" id="right-col">
            <div class="list-video">
                <h3 class="list-video-title">Xu hướng đọc</h3>  
                 <ul class="list-hot-video">
                     @Html.Raw(@ViewBag.trends)
                 </ul>
            </div>
    </div> 
</div>
    <script>
        isLogged='@ViewBag.userToken';
        currentUserToken='@ViewBag.userToken';
        currentUserName='@Html.Raw(@ViewBag.userName)';    
    
        //Hiển thị nextpage nếu thanh cuộn hết trang
        $(window).scroll(function () {
            if ($(window).scrollTop() + $(window).height() >= 400) {
                $("#backTopPage").show();
                //showNextPage();
            }
        });
    </script>   

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="/Content/new/js/bootstrap.min.js"></script>

    <script>

        $(document).ready(function () {
            $("button.button-top-menu").click(function () {

                var obj = $(this);

                if (obj.hasClass("active")) {
                    $(this).removeClass("active");
                    $("ul.nav.navbar-nav").removeClass("active");
                } else {
                    $(this).addClass("active");
                    $("ul.nav.navbar-nav").addClass("active");
                }

            });
        });
    </script>