@{
    ViewBag.Title = "Home Page";
}
@section featured {
    
            <div class="noticebox" id="noticebox" style="display:none"></div>
            <div class="backTopPage" id="backTopPage" style="display:none"><a href="#"><img src="/Images/toppage.png" title="Về đầu trang" height="48px" width="48px"></a></div>
            <div id="wrapper" class="wrapper">
	        </div>	         
            <div class="shareNews" id="shareNews">
            
            </div>
            <div class="dvCommentHomePage" id="dvCommentHomePage"></div>
            <div class=dvshowDetailNews id=dvshowDetailNews onclick="hideDetailNews();">
			    <div class=dvloading id=dvloading>
				    <div class=dvloadingDetail id=dvloadingDetail></div>
			    </div>			    
                <div id="dvsourceUrl" class="dvsourceUrl"></div>
			    <iframe class=ifrDetailNews src="about:blank" id=ifrDetailNews onload="loadingNews();"></iframe>
		    </div>
            <div class="topNews" id="topNews" style="display:none;">
                    Bình luận trong ngày<br />
            </div> 
            
}           
@section scripts {
    <script src="/Scripts/jquery-2.1.1.js"></script>
    <script src="/Scripts/jquery.signalR-1.1.3.min.js"></script>        
    <script src="/signalR/hubs"></script>
    <script src="/Scripts/OpenLayers.js" type="text/javascript"></script> 
    <script src="/Scripts/core.js" type="text/javascript"></script> 
    <script>
        var chat = $.connection.ync;
        var markers = [];
        var totalNews = [];
        var isRunning = false;
        var isLoadingXmlFile = false;
        
        $(function () {

            chat.client.broadCast = function (roomName, type,username, usertoken, contents, title, id, idNews) {
               
                if (contents != "" || title!="") {
                    if (document.getElementById("dvCommentHomePage")) {
                        //alert(title);
                        if (type == "1") {
                            $('#dvCommentHomePage').html('<span class=\"inforTinFont1\"><b>' + username + '</b> bình luận </span><a onclick=\"showDivComment(' + idNews + ',\'' + title + '\',\'\');\"><span class=\"inforTinFont1\" style=\"cursor:pointer\">' + title + '</span></a><div class=\"spaceNews\">&nbsp;</div><br>' + $('#dvCommentHomePage').html());
                        } else {
                            $('#dvCommentHomePage').html('<span class=\"inforTinFont1\"><b>Tin mới nhận</b> </span><a onclick=\"showDivComment(' + idNews + ',\'' + title + '\',\'\');\"><span class=\"inforTinFont1\" style=\"cursor:pointer\">' + title + '</span></a><div class=\"spaceNews\">&nbsp;</div><br>' + $('#dvCommentHomePage').html());
                        }
                        // just to scroll down the line 
                        //document.getElementById('dvCommentHomePage').scrollTop = document.getElementById('dvCommentHomePage').scrollHeight;
                    }
                }
            };
            //chat.client.broadCastUpdateNews = function (title, idNews) {
            //    if (title != "") {
            //        if (document.getElementById("dvCommentHomePage")) {
            //            //alert(title);
            //            $('#dvCommentHomePage').html('<span class=\"userchat\">Tin mới nhận <a onclick=\"showDivComment(' + idNews + ',\'' + title + '\',\'\');\"><span class=\"chatcontent\" style=\"cursor:pointer\">' + title + '</span></a><br><br>' + $('#dvCommentHomePage').html());
            //            // just to scroll down the line 
            //            //document.getElementById('dvCommentHomePage').scrollTop = document.getElementById('dvCommentHomePage').scrollHeight;
            //        }
            //    }
            //};
            $.connection.hub.start().done(function () {
                chat.server.joinRoom("broadCast", '', '', '', '',  '', '', '', '');
            });

        });
        function updateComment(val) {
            var userName = '';
            chat.server.joinRoom("Comment", val);
        }
        //Hiển thị nextpage nếu thanh cuộn hết trang
        $(window).scroll(function () {
            if ($(window).scrollTop() + $(window).height() >= $(document).height() - 10) {
                showNextPage();
            }
        });
        
        isLoadingXmlFile = false;
        getHotNewsFromFile();
        //getDailyTopNews();
        //getTopNewsWeekly();
        getFreshComment();
        isLoadingXmlFile = true;
        var percentLoading = 1;
        var stepLoading = 7;
        var myVar = null;
        
        function loadingDetailNews() {
            $("#dvloadingDetail").css({ "width": percentLoading });
            percentLoading += stepLoading;
            if (percentLoading > 1366) {
                clearInterval(myVar);
                document.getElementById("dvloading").style.display = "none";
                percentLoading = 1;
                stepLoading = 7;
            }
        }
        function myStopFunction() {
            clearInterval(myVar);
            percentLoading = 1;
        }


    </script>
    
}