@model IEnumerable<youknow.Models.content>
@{
    Layout = null;
}

<!DOCTYPE html>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="//tinymce.cachefly.net/4.1/tinymce.min.js"></script>
<style>
    body {
        font-size: 14px;
    }

    input {
        margin-left: 5px;
    }

        input#submit {
            width: 500px;
            height: 50px;
        }
</style>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>edit</title>
</head>
<body>
    <div>
        
        @foreach (var item in Model)
        {
            <div>
                <input type="hidden" value="@item.id" name="id" id="id" />
                <label>Title</label><input type="text" name="title" id="title" maxlength="150" size="100" value="@item.title" /><br />
                <label>Link nguồn(Tham khảo)</label><input type="text" name="link" id="link" maxlength="250" size="100" value="@item.link"/><br />
                <label>Des</label><input type="text" name="des" id="des" maxlength="550" style="height:100px;width:600px;" value="@item.des" /><br />
                <label>Link image</label><input type="text" name="image" id="image" maxlength="150" value="@item.image" /><br />

                <label>catid</label>
                <select name="catid" id="catid">
                    <option value="-1">Chọn chuyên mục</option>
                    <option value="1">Xã hội</option>
                    <option value="2">Thế giới</option>
                    <option value="3">Kinh tế</option>
                    <option value="4">Giáo dục</option>
                    <option value="5">Văn hóa</option>
                    <option value="6">Giới trẻ</option>
                    <option value="7">Độc - Lạ</option>
                    <option value="8">Game</option>
                    <option value="9">Công nghệ</option>
                    <option value="10">Thể thao</option>
                    <option value="11">Video</option>
                </select>
                <script>document.getElementById('catid').value=@item.catid;</script>
                <br />

                <label>Thể loại tin</label>
                <select name="groupid" id="groupid">
                    <option value="1" selected>Tin chính thống</option>
                    <option value="2">Tin giật gân</option>            
                </select>
                <script>document.getElementById('groupid').value=@item.groupid;</script>
                <br />
                <label>Vị trí trên trang chủ</label>
                <select name="moduleid" id="moduleid">
                    <option value="1" selected>Thuộc các chuyên mục</option>
                    <option value="2">Ảnh to nhất</option>  
                    <option value="3">Bên cạnh ảnh to</option>           
                </select>
                <script>document.getElementById('moduleid').value=@item.moduleid;</script>
                <br />
                <label>Nội dung đầy đủ</label><textarea name="fullcontent" id="fullcontent">@item.fullcontent</textarea><br />
        
                <input type="button" name="submit" id="submit" value="Sửa bài" />        

            </div>
        }
    </div>
    <div id="status"></div>

</body>
</html>

<script>
    $(document).ready(function () {

        tinymce.init({
            selector: 'textarea',
            entity_encoding: "raw",
            plugins: ["code"],
            height: 500,
        });        
        
        $("#submit").click(function () {
            $.ajax({
                type: "POST",
                url: "/editor/editpost",
                data: {
                    id: $("#id").val(),
                    title: $("#title").val(),
                    link: $("#link").val(),
                    des: $("#des").val(),
                    image: $("#image").val(),
                    fullcontent: tinymce.get('fullcontent').getContent(),
                    catid: $("#catid").val(),
                    groupid: $("#groupid").val(),
                    moduleid: $("#moduleid").val(),

                },
                success: function (resp) {
                    if (resp == "0") {
                        $("#status").append("lỗi");

                    }
                    else {
                        window.location = "/Editor/Index";
                        //$("#status").append('Ok => <a href="/editor/view/' + $("#id").val() + '" target="_blank" >Xem thử </a>');
                    }
                }
            })
        })
    });
</script>
