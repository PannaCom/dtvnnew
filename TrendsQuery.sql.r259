select A.title,A.keyword,A.rankKeyword,A.datetimeid,B.id,B.name,B.link,B.image,B.hasContent,B.maindomain,B.datetime from 
                (select title,keyword,status,ranking as rankKeyword,datetimeid from dailykeyword where status=1 and datetimeid>=20140518) as A left join 
               (select distinct isNull(image,'') as image,id,link,hasContent,name,ranking,datetime,datetimeid,maindomain from titles where datetimeid>=20140518) as B on CHARINDEX(A.keyword,B.name)>0 and B.datetimeid=A.datetimeid
                     order by A.keyword,A.datetimeid desc,A.rankKeyword desc,B.datetime desc,B.name,B.maindomain
					 
